###############################################################################
## req_compile bazel configuration
###############################################################################

# https://bazel.build/reference/command-line-reference#flag--enable_platform_specific_config
common --enable_platform_specific_config

# Speed up builds by skipping the creation of runfile links
build:linux --nobuild_runfile_links

# https://github.com/bazelbuild/bazel/issues/8195
build --incompatible_disallow_empty_glob=true

# Allow isolated module extensions for tests.
common --experimental_isolated_extension_usages

# https://github.com/bazelbuild/bazel/issues/12821
build:linux --nolegacy_external_runfiles
build --incompatible_use_plus_in_repo_names

# https://github.com/bazelbuild/bazel/issues/10076
build --incompatible_default_to_explicit_init_py

# Ensure errors are logged to the console
build --test_output=errors

coverage --combined_report=lcov

# Stream BES reports to BuildBuddy.
build:bes --bes_results_url=https://req-compile.buildbuddy.io/invocation/
build:bes --bes_backend=grpcs://req-compile.buildbuddy.io

# Attempt to import any CI flags
try-import %workspace%/.github/ci.bazelrc

###############################################################################
## Custom user flags
###############################################################################

try-import %workspace%/user.bazelrc
